import{e as R,d as D,x as t,a1 as ae,o as te,bD as ie,w as J,bE as se,br as K,as as re,aL as oe,b as ne,u as ue,bs as ce,aS as de,t as P,Y as fe,k as v,g as u,v as M,h as E,l as g,F as C,q as d,j as L,n as c,m as pe,au as Z,M as U,D as V,f as w,_ as ve,p as G,a7 as H,aU as ge,aq as Y,G as me,b7 as be,P as ye}from"./B9jAKPWx.js";function he(a){if(!a||a==="*")return;const z=a.split(",").map(x=>{const e=x.trim();return e.includes("/")&&e.endsWith("/*")&&e.split("/")[0]||e}).filter(x=>!x.startsWith("."));return z.length>0?z:void 0}function ze(a){const{accept:z="*",reset:x=!1,multiple:e=!1,dropzone:W=!0,onUpdate:B}=a,i=R(),m=R(),j=D(()=>he(t(z))),F=(r,y=!1)=>{if(!(!r||r.length===0)){if(r instanceof FileList&&(r=Array.from(r)),r.length>1&&!e&&(r=[r[0]]),y&&i.value?.$el)try{const h=new DataTransfer;r.forEach(p=>h.items.add(p)),i.value.$el.files=h.files}catch(h){console.warn("Could not sync files to input element:",h)}B(r)}},k=R(!1),T=ae({open:()=>{}});function b(){T.open()}return te(()=>{const{isOverDropZone:r}=W?ie(m,{dataTypes:j.value,onDrop:p=>F(p,!0)}):{isOverDropZone:R(!1)};J(r,p=>{k.value=p});const{onChange:y,open:h}=se({accept:t(z),multiple:e,input:t(i)?.$el,reset:x});T.open=h,y(p=>F(p,!1))}),{isDragging:k,open:b,inputRef:i,dropzoneRef:m}}const xe={slots:{root:"relative flex flex-col",base:["w-full flex-1 bg-default border border-default flex flex-col gap-2 items-stretch justify-center rounded-lg focus-visible:outline-2","transition-[background]"],wrapper:"flex flex-col items-center justify-center text-center",icon:"shrink-0",avatar:"shrink-0",label:"font-medium text-default mt-2",description:"text-muted mt-1",actions:"flex flex-wrap gap-1.5 shrink-0 mt-4",files:"",file:"relative",fileLeadingAvatar:"shrink-0",fileWrapper:"flex flex-col min-w-0",fileName:"text-default truncate",fileSize:"text-muted truncate",fileTrailingButton:""},variants:{color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},variant:{area:{wrapper:"px-4 py-3",base:"p-4"},button:{}},size:{xs:{base:"text-xs",icon:"size-4",file:"text-xs px-2 py-1 gap-1",fileWrapper:"flex-row gap-1"},sm:{base:"text-xs",icon:"size-4",file:"text-xs px-2.5 py-1.5 gap-1.5",fileWrapper:"flex-row gap-1"},md:{base:"text-sm",icon:"size-5",file:"text-xs px-2.5 py-1.5 gap-1.5"},lg:{base:"text-sm",icon:"size-5",file:"text-sm px-3 py-2 gap-2",fileSize:"text-xs"},xl:{base:"text-base",icon:"size-6",file:"text-sm px-3 py-2 gap-2"}},layout:{list:{root:"gap-2 items-start",files:"flex flex-col w-full gap-2",file:"min-w-0 flex items-center border border-default rounded-md w-full",fileTrailingButton:"ms-auto"},grid:{fileWrapper:"hidden",fileLeadingAvatar:"size-full rounded-lg",fileTrailingButton:"absolute -top-1.5 -end-1.5 p-0 rounded-full border-2 border-bg"}},position:{inside:"",outside:""},dropzone:{true:"border-dashed data-[dragging=true]:bg-elevated/25"},interactive:{true:""},highlight:{true:""},multiple:{true:""},disabled:{true:"cursor-not-allowed opacity-75"}},compoundVariants:[{color:"primary",class:"focus-visible:outline-primary"},{color:"secondary",class:"focus-visible:outline-secondary"},{color:"success",class:"focus-visible:outline-success"},{color:"info",class:"focus-visible:outline-info"},{color:"warning",class:"focus-visible:outline-warning"},{color:"error",class:"focus-visible:outline-error"},{color:"primary",highlight:!0,class:"border-primary"},{color:"secondary",highlight:!0,class:"border-secondary"},{color:"success",highlight:!0,class:"border-success"},{color:"info",highlight:!0,class:"border-info"},{color:"warning",highlight:!0,class:"border-warning"},{color:"error",highlight:!0,class:"border-error"},{color:"neutral",class:"focus-visible:outline-inverted"},{color:"neutral",highlight:!0,class:"border-inverted"},{size:"xs",layout:"list",class:{fileTrailingButton:"-me-1"}},{size:"sm",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"md",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"lg",layout:"list",class:{fileTrailingButton:"-me-2"}},{size:"xl",layout:"list",class:{fileTrailingButton:"-me-2"}},{variant:"button",size:"xs",class:{base:"p-1"}},{variant:"button",size:"sm",class:{base:"p-1.5"}},{variant:"button",size:"md",class:{base:"p-1.5"}},{variant:"button",size:"lg",class:{base:"p-2"}},{variant:"button",size:"xl",class:{base:"p-2"}},{layout:"grid",multiple:!0,class:{files:"grid grid-cols-2 md:grid-cols-3 gap-4 w-full",file:"p-0 aspect-square"}},{layout:"grid",multiple:!1,class:{file:"absolute inset-0 p-0"}},{interactive:!0,disabled:!1,class:"hover:bg-elevated/25"}],defaultVariants:{color:"primary",variant:"area",size:"md"}},Be=Object.assign({inheritAttrs:!1},{__name:"UFileUpload",props:K({as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},icon:{type:null,required:!1},label:{type:String,required:!1},description:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},layout:{type:null,required:!1,default:"grid"},position:{type:null,required:!1,default:"outside"},highlight:{type:Boolean,required:!1},accept:{type:String,required:!1,default:"*"},multiple:{type:Boolean,required:!1,default:!1},reset:{type:Boolean,required:!1,default:!1},dropzone:{type:Boolean,required:!1,default:!0},interactive:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},fileIcon:{type:null,required:!1},fileDelete:{type:[Boolean,Object],required:!1,default:!0},fileDeleteIcon:{type:null,required:!1},preview:{type:Boolean,required:!1,default:!0},class:{type:null,required:!1},ui:{type:null,required:!1}},{modelValue:{type:null},modelModifiers:{}}),emits:K(["change"],["update:modelValue"]),setup(a,{expose:z,emit:x}){const e=a,W=x,B=re(),i=oe(a,"modelValue"),m=ne(),{t:j}=ue(),[F,k]=ce(),{isDragging:T,open:b,inputRef:r,dropzoneRef:y}=ze({accept:e.accept,reset:e.reset,multiple:e.multiple,dropzone:e.dropzone,onUpdate:O}),{emitFormInput:h,emitFormChange:p,id:Q,name:X,disabled:S,ariaAttrs:_}=de(e),q=D(()=>e.multiple?"area":e.variant),N=D(()=>e.variant==="button"&&!e.multiple?"grid":e.layout),A=D(()=>N.value==="grid"&&e.multiple?"inside":q.value==="button"?"outside":e.position),s=D(()=>P({extend:P(xe),...m.ui?.fileUpload||{}})({dropzone:e.dropzone,interactive:e.interactive,color:e.color,size:e.size,variant:q.value,layout:N.value,position:A.value,multiple:e.multiple,highlight:e.highlight,disabled:e.disabled}));function ee(l){return URL.createObjectURL(l)}function le(l){if(l===0)return"0B";const n=1024,o=["B","KB","MB","GB"],f=Math.floor(Math.log(l)/Math.log(n)),I=l/Math.pow(n,f);return`${f===0?I.toString():I.toFixed(0)}${o[f]}`}function O(l,n=!1){if(e.multiple)if(n)i.value=l;else{const f=i.value||[];i.value=[...f,...l||[]]}else i.value=l?.[0];const o=new Event("change",{target:{value:i.value}});W("change",o),p(),h()}function $(l){if(!i.value)return;if(!e.multiple||l===void 0){O([],!0),y.value?.focus();return}const n=[...i.value];n.splice(l,1),O(n,!0),y.value?.focus()}return J(i,l=>{(e.multiple?!l?.length:!l)&&r.value?.$el&&(r.value.$el.value="")}),z({inputRef:fe(()=>r.value?.$el),dropzoneRef:y}),(l,n)=>(u(),v(C,null,[M(t(F),null,{default:E(()=>[e.preview&&i.value&&(!Array.isArray(i.value)||i.value.length)?(u(),v(C,{key:0},[d(l.$slots,"files-top",{files:i.value,open:t(b),removeFile:$}),L("div",{"data-slot":"files",class:c(s.value.files({class:e.ui?.files}))},[d(l.$slots,"files",{files:i.value},()=>[(u(!0),v(C,null,pe(Array.isArray(i.value)?i.value:[i.value],(o,f)=>(u(),v("div",{key:o.name,"data-slot":"file",class:c(s.value.file({class:e.ui?.file}))},[d(l.$slots,"file",{file:o,index:f},()=>[d(l.$slots,"file-leading",{file:o,index:f,ui:s.value},()=>[M(Z,{as:{img:"img"},src:ee(o),icon:a.fileIcon||t(m).ui.icons.file,size:e.size,"data-slot":"fileLeadingAvatar",class:c(s.value.fileLeadingAvatar({class:e.ui?.fileLeadingAvatar}))},null,8,["src","icon","size","class"])]),L("div",{"data-slot":"fileWrapper",class:c(s.value.fileWrapper({class:e.ui?.fileWrapper}))},[L("span",{"data-slot":"fileName",class:c(s.value.fileName({class:e.ui?.fileName}))},[d(l.$slots,"file-name",{file:o,index:f},()=>[U(V(o.name),1)])],2),L("span",{"data-slot":"fileSize",class:c(s.value.fileSize({class:e.ui?.fileSize}))},[d(l.$slots,"file-size",{file:o,index:f},()=>[U(V(le(o.size)),1)])],2)],2),d(l.$slots,"file-trailing",{file:o,index:f,ui:s.value},()=>[a.fileDelete?(u(),w(ve,G({key:0,color:"neutral"},{ref_for:!0},{...N.value==="grid"?{variant:"solid",size:"xs"}:{variant:"link",size:a.size},...typeof a.fileDelete=="object"?a.fileDelete:void 0},{"aria-label":t(j)("fileUpload.removeFile",{filename:o.name}),"trailing-icon":a.fileDeleteIcon||t(m).ui.icons.close,"data-slot":"fileTrailingButton",class:s.value.fileTrailingButton({class:e.ui?.fileTrailingButton}),onClick:H(I=>$(f),["stop","prevent"])}),null,16,["aria-label","trailing-icon","class","onClick"])):g("",!0)])])],2))),128))])],2),d(l.$slots,"files-bottom",{files:i.value,open:t(b),removeFile:$})],64)):g("",!0)]),_:3}),M(t(ye),{as:a.as,"data-slot":"root",class:c(s.value.root({class:[e.ui?.root,e.class]}))},{default:E(()=>[d(l.$slots,"default",{open:t(b),removeFile:$,ui:s.value},()=>[(u(),w(ge(q.value==="button"?"button":"div"),{ref_key:"dropzoneRef",ref:y,type:q.value==="button"?"button":void 0,role:q.value==="button"?void 0:"button","data-dragging":t(T),"data-slot":"base",class:c(s.value.base({class:e.ui?.base})),tabindex:a.interactive&&!t(S)?0:-1,onClick:n[0]||(n[0]=o=>a.interactive&&!t(S)&&t(b)()),onKeydown:n[1]||(n[1]=Y(H(()=>{},["prevent"]),["space"])),onKeyup:n[2]||(n[2]=Y(o=>a.interactive&&!t(S)&&t(b)(),["enter","space"]))},{default:E(()=>[A.value==="inside"?(u(),w(t(k),{key:0})):g("",!0),A.value!=="inside"||(a.multiple?!i.value?.length:!i.value)?(u(),v("div",{key:1,"data-slot":"wrapper",class:c(s.value.wrapper({class:e.ui?.wrapper}))},[d(l.$slots,"leading",{ui:s.value},()=>[q.value==="button"?(u(),w(me,{key:0,name:a.icon||t(m).ui.icons.upload,"data-slot":"icon",class:c(s.value.icon({class:e.ui?.icon}))},null,8,["name","class"])):(u(),w(Z,{key:1,icon:a.icon||t(m).ui.icons.upload,size:e.size,"data-slot":"avatar",class:c(s.value.avatar({class:e.ui?.avatar}))},null,8,["icon","size","class"]))]),q.value!=="button"?(u(),v(C,{key:0},[a.label||B.label?(u(),v("div",{key:0,"data-slot":"label",class:c(s.value.label({class:e.ui?.label}))},[d(l.$slots,"label",{},()=>[U(V(a.label),1)])],2)):g("",!0),a.description||B.description?(u(),v("div",{key:1,"data-slot":"description",class:c(s.value.description({class:e.ui?.description}))},[d(l.$slots,"description",{},()=>[U(V(a.description),1)])],2)):g("",!0),B.actions?(u(),v("div",{key:2,"data-slot":"actions",class:c(s.value.actions({class:e.ui?.actions}))},[d(l.$slots,"actions",{files:i.value,open:t(b),removeFile:$})],2)):g("",!0)],64)):g("",!0)],2)):g("",!0)]),_:3},40,["type","role","data-dragging","class","tabindex"])),A.value==="outside"?(u(),w(t(k),{key:0})):g("",!0)]),M(t(be),G({id:t(Q),ref_key:"inputRef",ref:r,as:"input",type:"file",feature:"fully-hidden",name:t(X),accept:a.accept,multiple:a.multiple,required:a.required,disabled:t(S)},{...l.$attrs,...t(_)}),null,16,["id","name","accept","multiple","required","disabled"])]),_:3},8,["as","class"])],64))}});export{Be as _};
