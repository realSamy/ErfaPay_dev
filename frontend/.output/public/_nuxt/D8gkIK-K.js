import{z as L,a1 as q,e as r,A as H,a5 as P,az as J,K as Q,I as W,d as p,aA as d,_ as v,k as S,g as j,v as g,j as _,x as l,i as A,D as I,h as X}from"./B9jAKPWx.js";import{_ as K}from"./OXrPZgjz.js";import{g as Y,_ as Z}from"./CboeWgWE.js";import{_ as ee}from"./f4Ke4YGl.js";import{b as te,a as ae}from"./mx1Kztk-.js";import{s as f,f as C}from"./DcDGsNhf.js";import{_ as oe}from"./D9Vt5tXq.js";import{_ as se}from"./D11N8NiO.js";import"./BfNhCRJB.js";import"./4JXGHORX.js";import"./B7bqkIxC.js";import"./DGQ0vsRx.js";import"./Dicm8otO.js";import"./C5Zklyxe.js";const le={class:"w-full space-y-4 pb-4"},ne={class:"flex justify-center border-t border-default pt-4"},ie=L({__name:"Tickets",async setup(z){let n,h;const c=q([]),b=r(!0);te().then(e=>{e.data.value?.ok&&c.splice(0,c.length,...e.data.value.data)}).finally(()=>b.value=!1);const{d:y,n:B,t,locale:u}=H(),k=P(),m=J("table"),w=r({pageIndex:0,pageSize:5}),U=Q("admin.users"),R=([n,h]=W(()=>ae()),n=await n,h(),n),D=p(()=>R.value.map(e=>({value:e.id,label:u.value==="en"?e.title_en:e.title_fa}))),M=p(()=>[{value:"open",label:t("common.ticket_status.open")},{value:"in_progress",label:t("common.ticket_status.in_progress")},{value:"closed",label:t("common.ticket_status.closed")},{value:"resolved",label:t("common.ticket_status.resolved")},{value:"waiting_user",label:t("common.ticket_status.waiting_user")}]),N=p(()=>[{value:"low",label:t("common.priorities.low")},{value:"medium",label:t("common.priorities.medium")},{value:"high",label:t("common.priorities.high")}]);p(()=>U.value.map(e=>({value:e.id,label:e.full_name})));const F=r([]),V=r([]),x=r([]),T=r([]),O=r([{accessorKey:"id",header:f("#"),cell:({row:e})=>{const a=e.getValue("id");return d(v,{label:B(a,{useGrouping:!1}),variant:"link",to:k({name:"dashboard-support-ticket-id",params:{id:a}})})}},{accessorKey:"ticket_id",header:f(t("common.tables.ticket_number")),cell:({row:e})=>{const a=e.getValue("ticket_id");return d(v,{label:oe(a,u.value),variant:"link",to:k({name:"dashboard-support-ticket-id",params:{id:a}})})}},{accessorKey:"subject",header:t("common.tables.topic"),cell:({row:e})=>{const a=e.getValue("ticket_id"),o=e.getValue("subject");return d(v,{label:o,variant:"link",to:k({name:"dashboard-support-ticket-id",params:{id:a}})})}},{accessorKey:"category",header:C(t("common.tables.category"),D,F),enableColumnFilter:!0,filterFn:(e,a,o)=>{const s=e.getValue(a);return s?o.includes(s.id):!1},sortingFn:(e,a,o)=>{const s=e.getValue(o),i=a.getValue(o);if(!s||!i)return 0;const E=s[`title_${u.value}`],G=i[`title_${u.value}`];return E.localeCompare(G)},cell:({row:e})=>e.getValue("category")?.[`title_${u.value}`]||"—"},{accessorKey:"status",header:C(t("common.tables.state"),M,V),enableColumnFilter:!0,filterFn:"arrIncludesSome",cell:({row:e})=>{const a=e.getValue("status"),{color:o,label:s}={open:{color:"warning",label:t("common.ticket_status.open")},in_progress:{color:"info",label:t("common.ticket_status.in_progress")},closed:{color:"success",label:t("common.ticket_status.closed")},resolved:{color:"success",label:t("common.ticket_status.resolved")},waiting_user:{color:"info",label:t("common.ticket_status.waiting_user")}}[a];return d(K,{class:"capitalize w-full justify-center",variant:"subtle",color:o},()=>s)}},{accessorKey:"priority",header:C(t("common.tables.priority"),N,x),enableColumnFilter:!0,filterFn:"arrIncludesSome",cell:({row:e})=>{const a=e.getValue("priority"),{color:o,label:s}={low:{color:"success",label:t("common.priorities.low")},medium:{color:"warning",label:t("common.priorities.medium")},high:{color:"error",label:t("common.priorities.high")}}[a];return d(K,{class:"capitalize w-full justify-center",variant:"subtle",color:o},()=>s)}},{accessorKey:"assigned_to",header:f(t("common.tables.assigned_to")),cell:({row:e})=>e.getValue("assigned_to")?.full_name||"—"},{accessorKey:"created_at",header:f(t("common.tables.created_at")),cell:({row:e})=>y(e.getValue("created_at"),{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}]),$=p(()=>{const e=[];return F.value.length&&e.push({id:"category",value:F.value}),V.value.length&&e.push({id:"status",value:V.value}),x.value.length&&e.push({id:"priority",value:x.value}),T.value.length&&e.push({id:"user",value:T.value}),e});return(e,a)=>{const o=Z,s=ee;return j(),S("div",le,[g(o,{ref_key:"table",ref:m,"column-filters":l($),"onUpdate:columnFilters":a[0]||(a[0]=i=>A($)?$.value=i:null),pagination:l(w),"onUpdate:pagination":a[1]||(a[1]=i=>A(w)?w.value=i:null),columns:l(O),data:l(c),filtering:!0,loading:l(b),"pagination-options":{getPaginationRowModel:l(Y)()},class:"h-100",sticky:""},null,8,["column-filters","pagination","columns","data","loading","pagination-options"]),_("div",ne,[g(s,{"default-page":(l(m)?.tableApi?.getState().pagination.pageIndex||0)+1,"items-per-page":l(m)?.tableApi?.getState().pagination.pageSize,total:l(m)?.tableApi?.getFilteredRowModel().rows.length,"onUpdate:page":a[2]||(a[2]=i=>l(m)?.tableApi?.setPageIndex(i-1))},null,8,["default-page","items-per-page","total"])])])}}}),re=Object.assign(ie,{__name:"TableDashboardTickets"}),ce={class:"space-y-20"},ue={class:"font-bold text-3xl"},xe=L({__name:"index",setup(z){return(n,h)=>{const c=v,b=re,y=se;return j(),S("div",ce,[_("section",null,[_("h1",ue,I(n.$t("common.titles.tickets")),1),_("p",null,I(n.$t("common.titles.tickets_desc")),1)]),_("section",null,[g(c,{label:n.$t("common.labels.new_ticket"),to:("useLocalePath"in n?n.useLocalePath:l(P))()("dashboard-support-new"),size:"xl","trailing-icon":"mdi:plus"},null,8,["label","to"]),g(y,null,{default:X(()=>[g(b)]),_:1})])])}}});export{xe as default};
